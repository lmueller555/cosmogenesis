COSMOGENESIS – `game_guidance`
(Authoritative Design – **Do Not Modify**)

---

## A. Meta-Rules for the LLM Coder

1. **This `game_guidance` document is authoritative.**

   * You **must not** edit, override, reinterpret, or “improve” this document.
   * You **must not** generate alternate or supplemental guidance documents (e.g., `game_guidance_v2`, `design_notes`, `balance_ideas`, etc.).
   * If you believe something is missing or ambiguous, you must surface it as a TODO or comment in the code and defer to the human designer.

2. **Relationship to other guidance.**

   * Ship details (stats, abilities, variants, lore, wireframe design) are defined in **`ship_guidance`**, which is also authoritative and must not be altered or replaced.
   * Research trees and tech nodes are defined in **`research_guidance`**, which is also authoritative and must not be altered or replaced.
   * Future documents (e.g., `upgrade_guidance`, `tech_guidance`, etc.) may be created **only by the human designer**, not by you. You must not invent these documents yourself.

3. **No new major systems without explicit instructions.**

   * You may refactor code for clarity, performance, and maintainability.
   * You may not introduce entirely new game mechanics (new resources, new unit classes, new tech trees, etc.) that change core gameplay without explicit human direction.

---

## B. High-Level Vision

**Cosmogenesis** is an Atari-style **wireframe real-time strategy (RTS)** game in Python using Pygame for windowing/input and **GPU-accelerated OpenGL** for rendering.

**Core fantasy:**

* You command a large **flagship/base station** in deep space, anchored to a planetoid in a vast sector.
* You mine nearby **planetoids** and **asteroids** for resources.
* You build additional bases and **facilities/modules** to expand your economy, unlock tech, and produce more advanced ships.
* You construct a fleet of Strike, Escort, Line, and Capital ships, issue waypoint-based orders, and fight across a large, fog-of-war-covered sector.
* You develop your fleet through **upgrades** and **research trees**, unlocking new ships and enhancements over time.
* The goal is to **destroy the opposing team’s bases and critical infrastructure** while defending your own.

**Tone & style:**

* Retro, minimalist **Atari wireframe** look: thin lines, dark background, simple but expressive shapes.
* Small, simple unit silhouettes focused on **clarity and performance**.
* Clean RTS UI with readable data and minimal clutter.

**Camera & viewpoint:**

* The game is played from a **top-down strategic viewpoint**, but:

  * The world and all objects are represented as **3D wireframe models**.
  * The camera is a **3D camera positioned above and slightly behind the scene**, at a shallow angle so ships and structures visibly have 3D depth.
  * The camera can **zoom in and out** using the **mouse scroll wheel**.
* Movement and gameplay are effectively constrained to a mostly flat sector plane, but visuals are true 3D, viewed from an angled top-down perspective.

---

## C. Technology & Rendering

1. **Language & Frameworks**

   * Primary language: **Python**.
   * Windowing, input, and general loop: **Pygame**.
   * **Rendering of game world objects (ships, bases, planetoids, asteroids, facilities/modules, projectiles, etc.) must be done on the GPU using OpenGL.**

     * Use an OpenGL wrapper (e.g., PyOpenGL or similar).
     * Pygame is primarily responsible for the window/context and events; heavy drawing must be via GPU-accelerated OpenGL.

2. **Rendering Style**

   * **Wireframes only.**

     * Objects are built from line segments forming geometric silhouettes.
     * No filled polygons, textures, complex shading, or sprite art; just lines.
   * **3D world, angled top-down camera.**

     * All major game entities (ships, bases, planetoids, asteroids, facilities) must be defined as **3D wireframe geometry** in world space (x, y, z).
     * Movement and gameplay can be treated as mostly 2D on a plane (e.g., z = 0 for ship movement), but geometry and camera are fully 3D.
     * The camera is a **3D perspective or orthographic camera** (designer’s choice, but must be consistent) positioned:

       * Above the sector, looking slightly “down and forward”, not perfectly vertical.
       * With a view direction that makes the 3D shapes clearly readable (e.g., a shallow tilt so ships/stations visibly have height).
   * **Camera zoom:**

     * The camera must support smooth **zoom in/out using the mouse scroll wheel**.
     * Zoom behavior may be implemented as:

       * Adjusting camera distance from the sector plane, or
       * Adjusting the projection parameters (e.g., field of view or orthographic size),
       * But must remain visually consistent and must not change the fundamental camera angle.

3. **Performance Goals**

   * Designed to handle **many small ships and multiple structures** simultaneously without frame drops.
   * Target frame rate: **≥ 60 FPS** on a typical modern machine.
   * Geometry should be low-poly:

     * Reuse vertex buffers for repeated ship/facility types.
     * Avoid regenerating geometry every frame.
   * Camera transforms must be done efficiently using standard model–view–projection matrices; avoid per-vertex Python computation in the main loop.

---

## D. Core Game Loop

A typical match of Cosmogenesis:

1. **Early Game**

   * Player starts with:

     * A primary **Base station** (e.g., Astral Citadel; see `ship_guidance`).
     * A starting planetoid for mining and a small number of asteroids nearby.
     * Limited initial tech and ship types (basic Strikes and perhaps basic Escorts).
   * Player sets up resource harvesting and builds initial Strike ships for scouting and light skirmishing.

2. **Expansion**

   * Player explores the **sector**, revealing terrain through the **fog of war**.
   * Additional **planetoids** and asteroid fields are discovered and evaluated.
   * Player constructs **new bases** and **facilities/modules** near planetoids, increasing resource income and unlocking more of the tech tree.

3. **Fleet Building & Tech Progression**

   * Player invests resources into:

     * Producing ships of various classes (Strike → Escort → Line → Capital).
     * Building **facilities** that unlock **tech/research trees** for ship upgrades, new ship hulls, economic upgrades, defensive modules, etc.
     * Researching upgrades and tech nodes that improve ships and structures.
   * Player gradually moves from simple early-game hulls to late-game Line and Capital ships as tech trees are advanced.

4. **Skirmishing & Map Control**

   * Strike and Escort ships scout, raid, and probe enemy holdings.
   * Line ships and Capitals establish and hold battle lines across key choke points.
   * Facilities and bases are attacked: destroying enemy tech structures can temporarily **cut off their access** to specific ships/upgrades until rebuilt.

5. **Late Game & Victory**

   * Largest fleets converge around bases and critical tech infrastructure.
   * The player who best balances **economy, tech progression, and tactical combat** will field the strongest fleet.
   * Game ends when the enemy’s base(s) and/or essential infrastructure are destroyed, preventing them from meaningfully continuing the fight (exact win conditions can be specified in detail later, but must respect this premise).

---

## E. World & Environment

1. **Sector**

   * A **single, large space sector** serves as the battlefield.
   * Map is significantly larger than the screen’s view; the camera pans over the sector.
   * Coordinates use a consistent in-game unit system (3D world space), typically with movement primarily on a sector plane (e.g., z = 0 for ship positions).

2. **Planetoids**

   * Large celestial bodies used as **primary mining sites**.
   * Bases are anchored **near** planetoids.
   * Each planetoid has:

     * Resource yield characteristics (high compared to asteroids).
     * A static position, important for pathfinding and building placement.
   * Planetoids are represented as **3D wireframe spheres or spheroids** (low-poly), projected through the angled top-down camera.

3. **Asteroids**

   * Small celestial bodies scattered across the sector.
   * Provide **small supplementary resources**.
   * Useful for early income and as minor points of interest.
   * Represented as small 3D wireframe rocks (simple irregular polyhedra or low-poly spheres).

4. **Bases**

   * A **Base** is a large station (see `ship_guidance` Base entry) that:

     * Anchors near a planetoid.
     * Hosts build queues for ships and may host or visually attach **modules/facilities** as tech progresses.
   * Additional bases can be built at other planetoids to increase mining capacity and ship production.
   * Bases are 3D wireframe structures whose geometry must be consistent with `ship_guidance` and visually readable from the angled top-down camera.

5. **Facilities & Modules (Physical Structures)**

   * **Facilities/modules** are specialized structures built **on or near bases** that:

     * Unlock specific **tech/research trees** (e.g., shipyard modules, research labs, defensive arrays).
     * Provide new upgrade paths or unlock new ship classes/hulls.
     * Have their own **resource_cost, build_time, health, and shields** (and may optionally have armor or other stats if later defined).
   * Facilities can be:

     * Visually represented as additional 3D wireframe structures integrated into or next to the base.
     * **Targeted and destroyed** by enemy units.

       * When destroyed, they **cut off access to their associated tech and research trees** until rebuilt (see Section J.4 for details).

---

## F. Economy & Resources

1. **Resources**

   * There is at least one core **resource** (“Resources”) used for:

     * Ship construction
     * Base construction/expansion
     * Facility/module construction
     * Tech/research and upgrades
   * Do **not** invent additional resource types unless explicitly instructed.

2. **Resource Acquisition**

   * **Planetoids**:

     * Primary sources of resources.
     * Require bases or mining facilities to harvest effectively.
   * **Asteroids**:

     * Provide smaller amounts of resources.
     * May be mined via small mining ships or extended base influence.

3. **Resource Flow**

   * Resources accumulate continuously as mining operations run.
   * Spending occurs when:

     * Ships are queued for production.
     * Bases/facilities are built or upgraded.
     * Research or upgrades are started.

---

## G. Fleet & Units (High-Level)

> **Details of individual ships (stats, hulls, lore, wireframe specifics) are in `ship_guidance`.**

1. **Common Ship Properties**

   * Each ship (Strike, Escort, Line, Capital, and Base) has at least:

     * Resource cost
     * Build time
     * Health (HP)
     * Armor
     * Shields
     * Energy & energy regen
     * Flight speed
     * Visual range
     * Radar range
     * **Firing range**
     * Weapon damage
   * Ships can be **upgraded** via tech/research to improve these stats or gain new abilities.

2. **Classes (Summary)**

   * **Strike Ships** (small, fast, fragile)

     * Scouts, skirmishers, raiders.
     * Low cost, short build time.

   * **Escort Ships** (medium)

     * Backbone combatants, escorts, or support vessels.
     * Moderate cost and build time.

   * **Line Ships** (large)

     * Heavy frontline units, cruisers, artillery.
     * High cost, longer build time.

   * **Capital Ships** (very large)

     * Flagships, command ships, siege platforms.
     * Very high cost, very long build time.

   * **Base** (largest structure)

     * Main production and economic hub.
     * Can be visually modified and functionally expanded via facilities/modules that unlock advanced ships and upgrade trees.

3. **Ship Variants**

   * Multiple ships per class with distinct roles (e.g., interceptor, recon, support, artillery).
   * All of these are specified in `ship_guidance`. The LLM coder must not add or remove variants without instruction.
   * All ships must have 3D wireframe hulls designed to remain recognizable from the angled top-down camera at various zoom levels.

---

## H. Fog of War, Vision, and Radar

1. **Fog of War**

   * The sector is initially covered in fog of war except around starting units/bases.
   * As ships move, they **reveal** terrain within their visual range.
   * Previously explored areas may remain as “memory” (visible terrain but hidden enemy units), depending on implementation choices approved by the human designer.

2. **Visual Range**

   * Each ship and base has a **visual range radius**.
   * Within visual range:

     * Enemy ships and structures are fully visible.
     * Fog of war is cleared.
   * Visual range should be implemented in world space (3D), but typically treated as a radius on the sector plane, consistent with the top-down strategic view.

3. **Radar Range**

   * Each ship and base also has an independent **radar range radius**.
   * Within radar range:

     * Enemy ships/structures may be detected as **blips** or simplified markers, even through fog.
   * Radar is primarily for:

     * Early warning
     * Strategic awareness

4. **UI Integration**

   * Radar data is shown on:

     * A **mini-map** or overview display.
     * Optional on-screen indicators.
   * The mini-map may be a 2D projection of the 3D world (e.g., x–y plane), independent of the camera angle.

---

## I. Controls & User Interface

1. **Unit Selection**

   * Player can:

     * Left-click to select individual ships.
     * Click-drag to select multiple ships with a selection box.
   * Selected ships are visually highlighted (e.g., brighter wireframe, small bounding shape, or selection circle), clearly visible from the angled top-down view.

2. **Movement & Waypoints**

   * Player selects ships then **right-clicks (or equivalent)** on the sector plane to set a waypoint.
   * Ships automatically path toward the waypoint.
   * Support for multiple waypoints (queueing) can be added; at minimum a single active waypoint per command.
   * Waypoints are expressed in world coordinates on the sector plane and rendered in the 3D scene in a way that is legible from the camera angle.

3. **Camera Control**

   * Camera pans across the sector via:

     * Keyboard (e.g., WASD/arrow keys), or
     * Other reasonable bindings (e.g., middle-mouse drag) as long as they are documented in code comments.
   * Camera orientation:

     * The camera must remain **top-down but slightly behind the scene**, at a consistent shallow tilt so 3D geometry is visible.
     * You must not switch to radically different cameras (e.g., first-person, side-on) without explicit human instruction.
   * **Zooming:**

     * The camera must support **zooming in and out via the mouse scroll wheel**.
     * Zooming should:

       * Allow tactical overview (zoomed out) and close-up inspection of ships/stations (zoomed in).
       * Maintain the same general viewing angle (tilt) while adjusting distance or projection parameters.
     * Implementation approach (distance vs. FOV/ortho size) is up to you, but must be:

       * Smooth,
       * Performance-conscious,
       * Clearly documented in comments.

4. **HUD / UI Elements**

   * At minimum, the HUD shows:

     * Current resources.
     * Selection panel with ship/base/facility stats (health, shields, etc.).
     * Build panel when a base or facility that can produce units is selected.
     * Mini-map with fog of war, radar blips, and base/ship icons.
   * Tech/research trees must have a dedicated UI section (see J.4).
   * UI must remain functional and readable regardless of camera zoom level.

---

## J. Construction, Production, Upgrades & Tech Trees

### J.1 Ship Production

* **Bases** and certain **shipyard-type facilities** maintain **build queues**.
* When the player clicks on a ship type:

  * If enough resources are available, that ship is added to the queue.
* Each queued ship:

  * Has a **build_time**, counting down continuously.
  * Consumes resources on queueing (or progressively, if explicitly implemented that way—use one consistent approach).
* When build_time completes:

  * The ship is spawned near the producing structure (base or shipyard) in 3D world space on/near the sector plane.
  * The ship typically appears idle or moves to a default rally point.

### J.2 Base Construction / Expansion

* Players can construct **additional bases** at other planetoids:

  * Often using a special construction ship or upgrade unlocked via tech.
  * New bases extend mining operations and add production capacity.
* Bases may have:

  * **Upgrade levels** that add module slots, shipyard capability, or improved defenses.
  * Visual representation of upgrades via additional 3D wireframe structures on/around the base model (rings, gantries, towers, etc.), clearly visible from the angled top-down camera.

### J.3 Upgrades (Stat & Ability Enhancements)

* Ships, bases, and facilities can receive **upgrades** via research (see J.4) or base/facility upgrade actions.
* Upgrades can:

  * Improve stats (health, armor, shields, damage, speed, vision, radar, etc.).
  * Unlock **new abilities** (active or passive).
  * Improve economy (mining rates, build times, etc.).
* Upgrades should be:

  * Organized into logical categories (e.g., Weapons, Defense, Mobility, Economy).
  * Clearly tied to **specific facilities** in the tech tree (see below).

> **Note:** Detailed, per-ship upgrade options belong in `ship_guidance` or a future human-authored `upgrade_guidance`, not invented by the LLM coder.

### J.4 Tech & Research Trees

**Core concept:** Tech/research trees determine what ships, upgrades, and structures are available. Access to these trees is mediated through **facilities/modules** that are built using resources.

1. **Tech Tree Structure**

   * Tech trees are composed of **nodes** (research items) organized by category:

     * Ship Hulls (unlock new ship types)
     * Weapon Systems (increase damage, range, firing patterns)
     * Defensive Systems (shields, armor, hull reinforcement)
     * Mobility & Sensors (speed, visual/radar range)
     * Economy (mining rates, base/facility efficiency)
   * Each node:

     * Has prerequisites (other nodes, facility presence, base level).
     * Has a **resource_cost** and **research_time**.
     * Unlocks one or more benefits (e.g., new ship hull, stat upgrade).

2. **Facility-Linked Tech Trees**

   * Tech trees are **not global by default**; they are accessed through **specific facilities**:

     * Example conceptual types (names are placeholders; final naming to be defined by the human designer):

       * **Shipwright Foundry:** unlocks advanced Strike/Escort ship hulls and related upgrades.
       * **Fleet Forge:** unlocks Line/Capital ships and heavy armaments.
       * **Research Nexus:** unlocks sensor, shield, and economic techs.
       * **Defense Grid Node:** unlocks base and station defensive upgrades.
   * Each facility may host:

     * One primary tech tree, or
     * Several tightly related tech branches.

3. **Research Process**

   * When an appropriate facility is **online** (built and not destroyed), the player can:

     * Open a **research UI panel** tied to that facility.
     * See available tech nodes and their prerequisites.
     * Queue research items, which consume resources and **research_time**.
   * Once research completes:

     * Its unlocked ships, upgrades, or structures become available for production or activation.
   * **Access restriction upon destruction:**

     * If a facility is **destroyed**, the player:

       * **Cannot start new research** from the tree(s) hosted by that facility.
       * **Cannot access the UI** to queue additional tech from that tree.
       * May be temporarily blocked from building certain ships/structures that require the facility to be present/online (depending on design; if implemented, follow human-authored specifics).
     * Already completed research remains globally known unless the human designer specifies otherwise.

4. **Rebuilding & Recovery**

   * Facilities can be **rebuilt** using resources and time:

     * Rebuilding restores access to the associated tech tree(s).
     * Researched tech progress is not lost by default; rebuilding simply re-enables further progress and associated production options.

### J.5 Facilities / Modules (Stats & Behavior)

Facilities/modules are **buildable, destructible structures** tied to tech and production.

1. **Common Facility Stats**

   * Each facility/module **must** have at least:

     * **resource_cost** – resources required to build it.
     * **build_time** – time required to construct it.
     * **health** – structural HP.
     * **shields** – shield HP pool.
   * Optional stats (if specified later):

     * Armor
     * Energy / energy_regen (for advanced facility abilities)
     * Local effects (e.g., buffs in an area)

2. **Placement & Ownership**

   * Facilities are built:

     * On the base station itself (visually attached as modules), or
     * As nearby structures in the vicinity of a base or planetoid, positioned in 3D world space but functionally associated with that base.
   * Ownership is tied to the player’s faction and associated base.

3. **Destruction**

   * Facilities can be targeted by enemy ships and destroyed:

     * When destroyed, they no longer provide their tech, production, or buff effects.
     * As specified above, destruction **cuts off access to their tech and research trees until rebuilt**.
   * Facilities may be priority targets in strategic assaults.

4. **Visual Integration**

   * Facilities and modules must be represented with **3D wireframe geometry**:

     * Small ring segments, spires, gantries, research towers, etc.
     * Their presence should visually change/augment the Base silhouette but stay low-poly.
   * Upgraded or specialized facilities may add additional line segments, mini-rings, or spires to represent enhanced capability, always readable from the angled top-down camera and at different zoom levels.

---

## K. AI & Opponents (High-Level)

1. **Opposing Teams**

   * At least one enemy faction is AI-controlled.
   * Future multiplayer is possible but not part of this guidance.

2. **AI Responsibilities**

   * Manage economy:

     * Build and upgrade bases and facilities.
     * Mine planetoids and asteroids.
   * Progress along tech trees:

     * Build facilities needed to unlock ships/tech.
     * Research upgrades and new hulls.
   * Produce fleets:

     * Use tech-appropriate ships as research unlocks them.
   * Conduct operations:

     * Scout player territory, raid miners, attack bases and facilities (particularly tech-critical ones).
     * Defend its own bases and tech infrastructure.

3. **Difficulty Controls**

   * Adjust AI behavior and power by:

     * Resource income scaling.
     * Build and research time modifiers.
     * Preferred tech paths (e.g., rush Capitals vs. mass Strikes).

---

## L. Performance & Optimization Requirements

1. **Wireframe Geometry**

   * Use **low vertex counts** for all ships, bases, and facilities.
   * Reuse static geometry:

     * Pre-create VAOs/VBOs for each ship/facility class and reuse per instance.
   * Minimize per-frame Python overhead in draw calls.
   * All transformations into camera space must be handled efficiently using matrix math on the GPU where possible.

2. **OpenGL Rendering**

   * Use GPU-side buffers (VBOs/IBOs).
   * Batch objects when possible (group by ship/facility type or shader state).
   * Avoid per-frame geometry recomputation; update transforms only.
   * Camera zoom and angle changes must be handled via matrices, not via regenerating geometry.

3. **Game Logic**

   * Avoid O(n²) operations over large fleets if possible; consider spatial partitioning when needed.
   * Keep AI and pathfinding efficient and scalable.

---

## M. Extensibility & Future Systems

The following are **possible future extensions**, but **must not** be implemented without explicit human guidance:

* Additional resources (e.g., rare minerals, fuel) and corresponding tech branches.
* Expanded, multi-layered tech trees including doctrines, doctrines per faction, etc.
* Campaign mode with persistent tech progress between missions.
* Environmental hazards (nebulae, ion storms, etc.) that interact with sensors/tech.
* Advanced strategic mechanics (alliances, diplomacy, star gates between sectors).

Any such expansion requires a human-authored document (e.g., `campaign_guidance`, `faction_guidance`, etc.).

---

## N. Final Reminder to the LLM Coder

* You **must not** modify this `game_guidance` document or create alternate guidance documents.
* You **must** follow this document, `ship_guidance`, and `research_guidance` when implementing Cosmogenesis.
* Tech and research systems, facilities, and modules must behave as described here:

  * Built using resources
  * Have resource_cost, build_time, health, and shields
  * Are destructible and directly gate access to their tech trees until rebuilt
* The camera must:

  * Be a **3D top-down, slightly angled camera** over a 3D wireframe world.
  * Support **zooming via the mouse scroll wheel** while maintaining a consistent overall angle.
* When in doubt:

  1. Choose the simplest implementation that aligns with this guidance, and
  2. Leave a clear comment/TODO for the human designer to review.
